<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stake $CMEM | 69% APY | Crab Memory</title>
    <meta name="description" content="Stake your $CMEM tokens for 69% APY. Because even crabs know diamond claws beat paper hands. Powered by Streamflow on Solana.">
    <meta property="og:title" content="Stake $CMEM ‚Äî 69% APY ü¶Ä">
    <meta property="og:description" content="Stake your $CMEM tokens for 69% APY. Diamond claws only.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://staking.cmem.ai">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Stake $CMEM ‚Äî 69% APY ü¶Ä">
    <meta name="twitter:description" content="Stake your $CMEM tokens for 69% APY. Diamond claws only.">
    <link rel="icon" href="/images/staking/crab-icon.webp" type="image/webp">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ü¶Ä</text></svg>" type="image/svg+xml">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;500;600;700&family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --ocean: #0a1628;
            --ocean-light: #0f2240;
            --ocean-mid: #132d54;
            --crab: #ff6b35;
            --crab-light: #ff8c5a;
            --crab-dark: #e05520;
            --sol-green: #00ffa3;
            --sol-green-dark: #00cc82;
            --white: #f0f0f0;
            --white-dim: #a0b0c0;
            --glass: rgba(15, 34, 64, 0.7);
            --glass-border: rgba(255, 107, 53, 0.2);
            --danger: #ff4757;
            --radius-card: 12px;
            --radius-btn: 8px;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html { scroll-behavior: smooth; }

        body {
            font-family: 'Inter', -apple-system, sans-serif;
            background: var(--ocean);
            color: var(--white);
            line-height: 1.6;
            overflow-x: hidden;
        }

        h1, h2, h3, h4 { font-family: 'Space Grotesk', sans-serif; }
        .mono { font-family: 'JetBrains Mono', monospace; }

        /* ========== NAV ========== */
        nav {
            position: fixed; top: 0; left: 0; right: 0; z-index: 1000;
            background: rgba(10, 22, 40, 0.9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--glass-border);
            padding: 0 1.5rem; height: 64px;
            display: flex; align-items: center; justify-content: space-between;
        }
        .nav-logo { display: flex; align-items: center; gap: 0.5rem; text-decoration: none; }
        .nav-logo img { width: 36px; height: 36px; border-radius: 50%; }
        .nav-logo span { font-family: 'Space Grotesk', sans-serif; font-weight: 700; font-size: 1.1rem; color: var(--crab); }
        .nav-links { display: flex; align-items: center; gap: 1.5rem; }
        .nav-links a { color: var(--white-dim); text-decoration: none; font-size: 0.85rem; font-weight: 500; transition: color 0.3s; }
        .nav-links a:hover { color: var(--white); }
        .nav-stake-btn {
            background: linear-gradient(135deg, var(--crab), var(--crab-dark));
            border: none; color: #fff; padding: 0.5rem 1.2rem;
            border-radius: var(--radius-btn); font-family: 'Space Grotesk', sans-serif;
            font-weight: 600; font-size: 0.85rem; cursor: pointer;
            transition: all 0.3s; box-shadow: 0 0 20px rgba(255, 107, 53, 0.3);
            text-decoration: none; display: inline-flex; align-items: center;
        }
        .nav-stake-btn:hover { transform: translateY(-1px); box-shadow: 0 0 30px rgba(255, 107, 53, 0.5); color: #fff; }
        @media (max-width: 768px) {
            .nav-links a:not(.nav-stake-btn) { display: none; }
        }

        /* ========== HERO ========== */
        .hero {
            position: relative; min-height: 100vh; display: flex;
            align-items: center; justify-content: center;
            padding: 80px 1.5rem 2rem; overflow: hidden;
        }
        .hero-bg {
            position: absolute; inset: 0;
            background: url('/images/staking/hero-bg.png') center/cover no-repeat;
            z-index: 0;
        }
        .hero-bg::after {
            content: ''; position: absolute; inset: 0;
            background: linear-gradient(180deg, rgba(10,22,40,0.75) 0%, rgba(10,22,40,0.88) 60%, var(--ocean) 100%);
        }
        .hero-content {
            position: relative; z-index: 2;
            display: grid; grid-template-columns: 1fr auto;
            align-items: center; gap: 3rem;
            max-width: 1200px; width: 100%;
        }
        .hero-text { min-width: 0; }
        .hero-badge {
            display: inline-block; background: rgba(255, 107, 53, 0.15);
            border: 1px solid rgba(255, 107, 53, 0.3); border-radius: 100px;
            padding: 0.4rem 1rem; font-size: 0.8rem; font-weight: 600;
            color: var(--crab-light); margin-bottom: 1.5rem;
            letter-spacing: 0.05em;
        }
        .hero-apy {
            font-family: 'Space Grotesk', sans-serif;
            font-size: clamp(4rem, 10vw, 8rem); font-weight: 700;
            line-height: 1;
            background: linear-gradient(135deg, var(--crab), var(--sol-green));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            background-clip: text; margin-bottom: 0.5rem;
        }
        .hero-sub {
            font-size: clamp(1rem, 2.5vw, 1.4rem);
            color: var(--white-dim); margin-bottom: 2rem; max-width: 500px;
        }
        .hero-cta {
            display: inline-flex; align-items: center; gap: 0.5rem;
            background: linear-gradient(135deg, var(--crab), var(--crab-dark));
            color: #fff; border: none; padding: 1.2rem 3rem;
            border-radius: 16px; font-family: 'Space Grotesk', sans-serif;
            font-weight: 700; font-size: 1.3rem; cursor: pointer;
            transition: all 0.3s; text-decoration: none;
            animation: ctaGlow 2s ease-in-out infinite;
        }
        @keyframes ctaGlow {
            0%, 100% { box-shadow: 0 0 20px rgba(255,107,53,0.4); }
            50% { box-shadow: 0 0 40px rgba(255,107,53,0.7), 0 0 80px rgba(255,107,53,0.3); }
        }
        .hero-cta:hover { transform: translateY(-2px) scale(1.02); }

        /* Hero stats bar */
        .hero-stats {
            display: flex; gap: 2.5rem; margin-top: 2.5rem;
            padding-top: 1.5rem; border-top: 1px solid rgba(255,255,255,0.08);
        }
        .hero-stat-item { text-align: left; }
        .hero-stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: 1.6rem; font-weight: 700; color: var(--sol-green);
        }
        .hero-stat-label { font-size: 0.7rem; color: var(--white-dim); text-transform: uppercase; letter-spacing: 0.12em; margin-top: 0.15rem; }

        /* Hero crab - right aligned, no overlap */
        .hero-crab { flex-shrink: 0; text-align: right; }
        .hero-crab img {
            width: clamp(220px, 28vw, 400px); height: auto;
            animation: crabBounce 3s ease-in-out infinite;
            filter: drop-shadow(0 20px 60px rgba(255,107,53,0.3));
        }
        @keyframes crabBounce {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            25% { transform: translateY(-15px) rotate(1deg); }
            75% { transform: translateY(5px) rotate(-1deg); }
        }

        /* Top Stakers preview */
        .hero-top-stakers {
            margin-top: 1.5rem;
            background: rgba(15, 34, 64, 0.6);
            backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-card); padding: 1rem 1.2rem;
            max-width: 360px;
        }
        .hero-top-stakers h4 {
            font-size: 0.7rem; text-transform: uppercase; letter-spacing: 0.12em;
            color: var(--white-dim); margin-bottom: 0.6rem;
        }
        .top-staker-row {
            display: flex; align-items: center; gap: 0.5rem;
            padding: 0.35rem 0; font-size: 0.8rem;
        }
        .top-staker-row .ts-rank { font-weight: 700; width: 1.8rem; }
        .top-staker-row .ts-addr { font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: var(--white-dim); flex: 1; }
        .top-staker-row .ts-amount { font-family: 'JetBrains Mono', monospace; font-weight: 600; color: var(--sol-green); font-size: 0.8rem; }

        @media (max-width: 768px) {
            .hero-content { grid-template-columns: 1fr; text-align: center; }
            .hero-crab { text-align: center; order: -1; }
            .hero-crab img { width: 180px; opacity: 0.9; }
            .hero-stats { justify-content: center; gap: 1.5rem; }
            .hero-sub { margin-left: auto; margin-right: auto; }
            .hero-top-stakers { margin-left: auto; margin-right: auto; }
            .hero { padding: 80px 1rem 2rem; }
        }

        /* Wave divider */
        .wave-divider { position: absolute; bottom: -2px; left: 0; right: 0; z-index: 3; }
        .wave-divider svg { display: block; width: 100%; height: auto; }

        /* ========== SECTIONS ========== */
        section { padding: 3.5rem 1.5rem; position: relative; }
        .section-inner { max-width: 1100px; margin: 0 auto; }
        .section-title {
            font-size: clamp(1.8rem, 4vw, 2.5rem); font-weight: 700;
            text-align: center; margin-bottom: 0.4rem;
        }
        .section-subtitle {
            text-align: center; color: var(--white-dim);
            font-size: 1rem; margin-bottom: 2.5rem; max-width: 600px;
            margin-left: auto; margin-right: auto;
        }

        /* Section divider */
        .section-divider {
            height: 1px; max-width: 200px; margin: 0 auto 2rem;
            background: linear-gradient(90deg, transparent, var(--crab), var(--sol-green), transparent);
        }

        /* Scroll reveal */
        .reveal {
            opacity: 0; transform: translateY(24px);
            transition: opacity 0.5s ease, transform 0.5s ease;
        }
        .reveal.visible { opacity: 1; transform: translateY(0); }

        /* ========== HOW IT WORKS ========== */
        .how-cards {
            display: grid; grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
        }
        .how-card {
            background: var(--glass);
            backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-card); padding: 2rem 1.5rem; text-align: center;
            transition: all 0.3s; position: relative; overflow: hidden;
        }
        .how-card:hover { transform: translateY(-5px); border-color: var(--crab); }
        .how-card::before {
            content: ''; position: absolute; top: 0; left: 0; right: 0;
            height: 3px; background: linear-gradient(90deg, var(--crab), var(--sol-green));
            transform: scaleX(0); transition: transform 0.3s; transform-origin: left;
        }
        .how-card:hover::before { transform: scaleX(1); }
        .how-step {
            width: 56px; height: 56px; border-radius: 50%;
            background: linear-gradient(135deg, var(--crab), var(--crab-dark));
            display: flex; align-items: center; justify-content: center;
            font-family: 'Space Grotesk', sans-serif; font-weight: 700;
            font-size: 1.4rem; margin: 0 auto 1rem;
            box-shadow: 0 4px 20px rgba(255,107,53,0.3);
        }
        .how-card-icon { font-size: 2.5rem; margin-bottom: 0.75rem; line-height: 1; }
        .how-card h3 { font-size: 1.15rem; margin-bottom: 0.5rem; }
        .how-card p { color: var(--white-dim); font-size: 0.9rem; line-height: 1.6; }
        @media (max-width: 768px) {
            .how-cards { grid-template-columns: 1fr; }
        }

        /* ========== POOL STATS ========== */
        .stats-section { background: var(--ocean-light); }
        .stats-grid {
            display: grid; grid-template-columns: repeat(4, 1fr);
            gap: 1.2rem;
        }
        .stat-card {
            background: var(--glass);
            backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-card); padding: 1.5rem 1rem; text-align: center;
            transition: all 0.3s;
        }
        .stat-card:hover { border-color: var(--crab); transform: translateY(-2px); }
        .stat-icon { font-size: 1.3rem; margin-bottom: 0.4rem; }
        .stat-value {
            font-family: 'JetBrains Mono', monospace;
            font-size: clamp(2rem, 4vw, 3rem); font-weight: 700;
            color: var(--sol-green); margin-bottom: 0.2rem;
            line-height: 1.1;
        }
        .stat-label { font-size: 0.7rem; color: var(--white-dim); text-transform: uppercase; letter-spacing: 0.1em; }
        #countdownValue {
            color: var(--crab) !important;
            font-size: clamp(1.6rem, 3vw, 2.4rem) !important;
        }
        @media (max-width: 768px) {
            .stats-grid { grid-template-columns: repeat(2, 1fr); }
        }

        /* ========== STAKING WIDGET ========== */
        .widget-section { background: var(--ocean); }
        .widget-container { max-width: 520px; margin: 0 auto; }
        .widget {
            background: rgba(15, 34, 64, 0.5);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 107, 53, 0.25);
            border-radius: var(--radius-card); padding: 2.5rem; position: relative;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3), 0 0 40px rgba(255,107,53,0.08);
            text-align: center;
        }
        .widget-ready-title {
            font-family: 'Space Grotesk', sans-serif;
            font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem;
        }
        .widget-ready-sub {
            color: var(--white-dim); font-size: 1rem; margin-bottom: 2rem;
            line-height: 1.6;
        }
        .mega-stake-btn {
            display: inline-flex; align-items: center; justify-content: center;
            gap: 0.5rem; width: 100%;
            background: linear-gradient(135deg, var(--crab), #ff4500, var(--crab-dark));
            background-size: 200% 200%;
            animation: megaGlow 2s ease-in-out infinite, gradientShift 3s ease infinite;
            border: none; border-radius: 16px; color: #fff;
            font-family: 'Space Grotesk', sans-serif; font-weight: 700;
            font-size: 1.5rem; padding: 1.4rem 2rem;
            cursor: pointer; transition: all 0.3s;
            text-decoration: none;
        }
        @keyframes megaGlow {
            0%, 100% { box-shadow: 0 0 30px rgba(255,107,53,0.5), 0 0 60px rgba(255,107,53,0.2); }
            50% { box-shadow: 0 0 50px rgba(255,107,53,0.8), 0 0 100px rgba(255,107,53,0.4), 0 0 150px rgba(255,107,53,0.1); }
        }
        @keyframes gradientShift {
            0%, 100% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
        }
        .mega-stake-btn:hover { transform: translateY(-3px) scale(1.03); }
        .widget-hint {
            margin-top: 1rem; font-size: 0.8rem; color: var(--white-dim); line-height: 1.5;
        }
        .widget-hint a { color: var(--sol-green); text-decoration: none; }
        .widget-hint a:hover { text-decoration: underline; }
        .streamflow-badge {
            display: flex; align-items: center; justify-content: center;
            gap: 0.5rem; margin-top: 1.2rem; font-size: 0.75rem; color: var(--white-dim);
        }
        .streamflow-badge a { color: var(--sol-green); text-decoration: none; }
        .streamflow-badge a:hover { text-decoration: underline; }

        /* Calculator */
        .calculator {
            background: var(--glass);
            backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-card); padding: 1.5rem; margin-top: 1.5rem;
        }
        .calculator h4 { font-size: 0.95rem; margin-bottom: 1.2rem; color: var(--crab-light); }
        .calc-row {
            display: grid; grid-template-columns: 80px 1fr 100px;
            align-items: center; gap: 0.75rem; margin-bottom: 1rem;
        }
        .calc-row label { font-size: 0.85rem; color: var(--white-dim); }
        .calc-row input[type="range"] {
            width: 100%; accent-color: var(--crab); height: 6px;
            -webkit-appearance: none; background: rgba(255,255,255,0.1);
            border-radius: 3px; outline: none;
        }
        .calc-row input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none; width: 18px; height: 18px;
            border-radius: 50%; background: var(--crab); cursor: pointer;
            box-shadow: 0 0 10px rgba(255,107,53,0.4);
        }
        .calc-row .calc-val {
            font-family: 'JetBrains Mono', monospace; font-weight: 600;
            color: var(--sol-green); font-size: 0.9rem; text-align: right;
        }
        .calc-result {
            text-align: center; padding: 1.2rem; margin-top: 0.5rem;
            background: rgba(0,255,163,0.05); border: 1px solid rgba(0,255,163,0.2);
            border-radius: var(--radius-card);
        }
        .calc-result .big-num {
            font-family: 'JetBrains Mono', monospace; font-size: 2.2rem;
            font-weight: 700; color: var(--sol-green);
        }
        .calc-result .label { font-size: 0.75rem; color: var(--white-dim); }

        /* ========== WHY STAKE ========== */
        .why-section { background: var(--ocean-light); }
        .why-grid {
            display: grid; grid-template-columns: 1fr 1fr; gap: 3rem;
            align-items: center;
        }
        .why-text { order: 1; }
        .why-image { order: 2; }
        .why-image img { width: 100%; border-radius: var(--radius-card); box-shadow: 0 20px 60px rgba(0,0,0,0.4); }
        .why-text h3 { font-size: 1.5rem; margin-bottom: 1rem; color: var(--crab-light); }
        .why-text p { color: var(--white-dim); margin-bottom: 1.5rem; font-size: 1rem; line-height: 1.8; }
        .why-list { list-style: none; }
        .why-list li {
            padding: 0.75rem 0 0.75rem 2.5rem; position: relative;
            font-size: 0.95rem; color: var(--white-dim);
            border-bottom: 1px solid rgba(255,255,255,0.05);
            transition: color 0.3s;
        }
        .why-list li:hover { color: var(--white); }
        .why-list li::before {
            content: 'ü¶Ä'; position: absolute; left: 0; top: 0.75rem;
            font-size: 1.1rem;
        }
        .why-list li:last-child { border-bottom: none; }
        @media (max-width: 768px) {
            .why-grid { grid-template-columns: 1fr; }
            .why-image { order: -1; }
        }

        /* ========== LEADERBOARD ========== */
        .leaderboard-controls {
            display: flex; gap: 1rem; margin-bottom: 1.5rem; flex-wrap: wrap;
        }
        .lb-search {
            flex: 1; min-width: 200px; padding: 0.7rem 1rem;
            background: var(--glass); border: 1px solid var(--glass-border);
            border-radius: var(--radius-btn); color: var(--white);
            font-family: 'Inter', sans-serif; font-size: 0.9rem; outline: none;
            transition: border-color 0.3s;
        }
        .lb-search:focus { border-color: var(--crab); }
        .lb-search::placeholder { color: var(--white-dim); }
        .lb-sort {
            padding: 0.7rem 1rem; background: var(--glass);
            border: 1px solid var(--glass-border); border-radius: var(--radius-btn);
            color: var(--white); font-family: 'Inter', sans-serif;
            font-size: 0.9rem; cursor: pointer; transition: border-color 0.3s;
        }
        .lb-sort:focus { border-color: var(--crab); }

        /* Desktop table */
        .lb-table-wrap { border-radius: var(--radius-card); overflow: hidden; }
        .leaderboard-table {
            width: 100%; border-collapse: collapse;
            background: var(--glass); border: 1px solid var(--glass-border);
        }
        .leaderboard-table th {
            padding: 0.85rem 1rem; text-align: left; font-size: 0.7rem;
            text-transform: uppercase; letter-spacing: 0.1em;
            color: var(--white-dim); background: rgba(0,0,0,0.3);
            cursor: pointer; user-select: none; transition: color 0.3s;
        }
        .leaderboard-table th:hover { color: var(--crab); }
        .leaderboard-table th:nth-child(5) { min-width: 100px; }
        .leaderboard-table td {
            padding: 0.75rem 1rem;
            border-bottom: 1px solid rgba(255,255,255,0.04);
            font-size: 0.85rem; transition: background 0.3s;
        }
        .leaderboard-table tbody tr:nth-child(even) td { background: rgba(0,0,0,0.1); }
        .leaderboard-table tbody tr:hover td { background: rgba(255,107,53,0.07); }
        .rank-cell { font-weight: 700; }
        .rank-1 { color: #ffd700; }
        .rank-2 { color: #c0c0c0; }
        .rank-3 { color: #cd7f32; }
        .addr-cell {
            font-family: 'JetBrains Mono', monospace; font-size: 0.78rem;
            color: var(--white-dim); max-width: 140px;
            overflow: hidden; text-overflow: ellipsis; white-space: nowrap;
        }
        .amount-cell { font-family: 'JetBrains Mono', monospace; font-weight: 600; color: var(--sol-green); }
        .badge-cell { font-size: 1.1rem; min-width: 80px; }
        .share-btn {
            background: none; border: 1px solid rgba(255,255,255,0.1);
            color: var(--white-dim); padding: 0.3rem 0.6rem; border-radius: 6px;
            font-size: 0.7rem; cursor: pointer; transition: all 0.3s;
        }
        .share-btn:hover { border-color: #1da1f2; color: #1da1f2; }

        /* Mobile card layout for leaderboard */
        .lb-cards { display: none; }
        @media (max-width: 768px) {
            .lb-table-wrap { display: none; }
            .lb-cards { display: flex; flex-direction: column; gap: 0.75rem; }
            .lb-card {
                background: var(--glass);
                backdrop-filter: blur(12px);
                border: 1px solid var(--glass-border);
                border-radius: var(--radius-card); padding: 1rem 1.2rem;
                display: grid; grid-template-columns: auto 1fr auto;
                align-items: center; gap: 0.75rem;
                transition: border-color 0.3s;
            }
            .lb-card:hover { border-color: var(--crab); }
            .lb-card-rank { font-weight: 700; font-size: 1.1rem; width: 2.5rem; text-align: center; }
            .lb-card-info { min-width: 0; }
            .lb-card-addr { font-family: 'JetBrains Mono', monospace; font-size: 0.75rem; color: var(--white-dim); overflow: hidden; text-overflow: ellipsis; white-space: nowrap; }
            .lb-card-amount { font-family: 'JetBrains Mono', monospace; font-weight: 600; color: var(--sol-green); font-size: 0.9rem; }
            .lb-card-meta { font-size: 0.75rem; color: var(--white-dim); }
            .lb-card-badge { font-size: 1.3rem; text-align: right; }
        }

        /* ========== CONTRACT INFO ========== */
        .contract-section {
            background: var(--ocean-light);
        }
        .contract-grid {
            display: grid; grid-template-columns: 1fr 1fr;
            gap: 1.2rem;
        }
        .contract-card {
            background: var(--glass);
            backdrop-filter: blur(12px);
            border: 1px solid var(--glass-border);
            border-radius: var(--radius-card); padding: 1.5rem;
            transition: border-color 0.3s;
        }
        .contract-card:hover { border-color: rgba(255,107,53,0.4); }
        .contract-card.full-width { grid-column: 1 / -1; }
        .contract-card h4 {
            font-size: 0.75rem; text-transform: uppercase;
            letter-spacing: 0.1em; color: var(--white-dim); margin-bottom: 0.75rem;
        }
        .contract-addr {
            display: flex; align-items: center; gap: 0.5rem;
            background: rgba(0,0,0,0.3); padding: 0.85rem 1rem;
            border-radius: var(--radius-btn); margin-bottom: 0.75rem;
        }
        .contract-addr code {
            font-family: 'JetBrains Mono', monospace; font-size: 0.78rem;
            color: var(--sol-green); word-break: break-all; flex: 1;
        }
        .copy-btn {
            background: rgba(255,107,53,0.15); border: 1px solid rgba(255,107,53,0.3);
            color: var(--crab); padding: 0.35rem 0.7rem; border-radius: 6px;
            font-size: 0.7rem; cursor: pointer; transition: all 0.3s;
            white-space: nowrap; font-family: 'Inter', sans-serif;
        }
        .copy-btn:hover { background: rgba(255,107,53,0.3); }
        .contract-links { display: flex; gap: 0.6rem; flex-wrap: wrap; }
        .contract-link-btn {
            display: inline-flex; align-items: center; gap: 0.3rem;
            font-size: 0.78rem; color: var(--sol-green);
            text-decoration: none; padding: 0.4rem 0.8rem;
            background: rgba(0,255,163,0.08);
            border: 1px solid rgba(0,255,163,0.15);
            border-radius: 6px; transition: all 0.3s;
        }
        .contract-link-btn:hover { background: rgba(0,255,163,0.15); border-color: rgba(0,255,163,0.3); }
        .verified-badge {
            display: inline-flex; align-items: center; gap: 0.3rem;
            background: rgba(0,255,163,0.1); border: 1px solid rgba(0,255,163,0.2);
            padding: 0.2rem 0.6rem; border-radius: 6px;
            font-size: 0.75rem; color: var(--sol-green); font-weight: 600;
        }
        .pool-params {
            display: grid; gap: 0.5rem; font-size: 0.88rem;
        }
        .pool-param {
            display: flex; justify-content: space-between; align-items: center;
            padding: 0.5rem 0;
            border-bottom: 1px solid rgba(255,255,255,0.04);
        }
        .pool-param:last-child { border-bottom: none; }
        .pool-param-label { color: var(--white-dim); }
        .pool-param-value { font-family: 'JetBrains Mono', monospace; font-weight: 500; }
        @media (max-width: 768px) {
            .contract-grid { grid-template-columns: 1fr; }
            .contract-addr code { font-size: 0.68rem; }
        }

        /* ========== FAQ ========== */
        .faq-list { max-width: 700px; margin: 0 auto; }
        .faq-item {
            border: 1px solid var(--glass-border); border-radius: var(--radius-card);
            margin-bottom: 0.6rem; overflow: hidden;
            background: var(--glass); transition: border-color 0.3s;
        }
        .faq-item:hover { border-color: rgba(255,107,53,0.4); }
        .faq-q {
            display: flex; justify-content: space-between; align-items: center;
            padding: 1rem 1.3rem; cursor: pointer; font-weight: 600;
            font-family: 'Space Grotesk', sans-serif; font-size: 0.95rem;
            user-select: none; transition: color 0.3s;
        }
        .faq-q:hover { color: var(--crab-light); }
        .faq-toggle {
            width: 24px; height: 24px; display: flex; align-items: center; justify-content: center;
            font-size: 1.1rem; color: var(--crab); transition: transform 0.3s;
            flex-shrink: 0;
        }
        .faq-item.open .faq-toggle { transform: rotate(45deg); }
        .faq-a {
            max-height: 0; overflow: hidden; transition: max-height 0.4s ease, padding 0.3s;
            padding: 0 1.3rem;
        }
        .faq-item.open .faq-a {
            max-height: 300px; padding: 0 1.3rem 1rem;
        }
        .faq-a-inner {
            background: rgba(0,0,0,0.15); border-radius: 8px; padding: 1rem;
        }
        .faq-a p { color: var(--white-dim); font-size: 0.9rem; line-height: 1.7; }

        /* ========== FOOTER ========== */
        footer {
            padding: 2.5rem 1.5rem; text-align: center;
            border-top: 1px solid var(--glass-border);
        }
        .footer-inner { max-width: 800px; margin: 0 auto; }
        .footer-links { display: flex; justify-content: center; gap: 2rem; margin-bottom: 1rem; flex-wrap: wrap; }
        .footer-links a { color: var(--white-dim); text-decoration: none; font-size: 0.85rem; transition: color 0.3s; }
        .footer-links a:hover { color: var(--crab); }
        .footer-tagline { font-size: 0.8rem; color: var(--white-dim); margin-bottom: 0.3rem; }
        .footer-addr { font-family: 'JetBrains Mono', monospace; font-size: 0.65rem; color: rgba(160,176,192,0.5); word-break: break-all; }

        /* ========== MOBILE OVERRIDES ========== */
        @media (max-width: 768px) {
            section { padding: 2.5rem 1rem; }
            .section-subtitle { margin-bottom: 2rem; font-size: 0.9rem; }
            .stat-value { font-size: 1.8rem !important; }
            .calc-result .big-num { font-size: 1.6rem; }
            .widget { padding: 2rem 1.5rem; }
        }

        /* ========== GRADIENT LINE ========== */
        .gradient-line {
            height: 2px; width: 60px;
            background: linear-gradient(90deg, var(--crab), var(--sol-green));
            margin: 0 auto 0.8rem;
            border-radius: 1px;
        }
    </style>
</head>
<body>

<!-- NAV -->
<nav>
    <a class="nav-logo" href="/">
        <img src="/images/staking/crab-icon.webp" alt="CMEM" onerror="this.style.display='none'">
        <span>$CMEM</span>
    </a>
    <div class="nav-links">
        <a href="#how">How It Works</a>
        <a href="#stake">Stake</a>
        <a href="#leaderboard">Leaderboard</a>
        <a href="#faq">FAQ</a>
        <a class="nav-stake-btn" href="https://app.streamflow.finance/staking/solana/mainnet/2uBHsavcfVQAgs8nMuMwogaap9BV1MwQuADearz1e6Kg" target="_blank" rel="noopener noreferrer">Stake Now ‚Üó</a>
    </div>
</nav>

<!-- HERO -->
<section class="hero">
    <div class="hero-bg"></div>
    <div class="hero-content">
        <div class="hero-text">
            <div class="hero-badge">üîí STAKING LIVE ON SOLANA</div>
            <div class="hero-apy">69% APY</div>
            <p class="hero-sub">Stake your $CMEM and earn rewards so fat, even other crabs will be jealous. Diamond claws get rewarded.</p>
            <a href="https://app.streamflow.finance/staking/solana/mainnet/2uBHsavcfVQAgs8nMuMwogaap9BV1MwQuADearz1e6Kg" target="_blank" rel="noopener noreferrer" class="hero-cta">ü¶Ä Start Staking ‚Üó</a>
            <div class="hero-stats">
                <div class="hero-stat-item">
                    <div class="hero-stat-value" id="heroTotalStaked" style="color:var(--sol-green)">Loading...</div>
                    <div class="hero-stat-label">Total Staked</div>
                </div>
                <div class="hero-stat-item">
                    <div class="hero-stat-value" style="color:var(--crab)">69%</div>
                    <div class="hero-stat-label">APY</div>
                </div>
                <div class="hero-stat-item">
                    <div class="hero-stat-value" data-count="30" data-suffix=" days">0</div>
                    <div class="hero-stat-label">Min Lock</div>
                </div>
            </div>
            <!-- Top 3 Stakers Preview -->
            <div class="hero-top-stakers" id="heroTopStakers">
                <h4>üëë Top Stakers</h4>
                <div id="heroTopList">
                    <div class="top-staker-row"><span class="ts-rank" style="color:#ffd700">ü•á</span><span class="ts-addr">Loading...</span><span class="ts-amount">‚Äî</span></div>
                    <div class="top-staker-row"><span class="ts-rank" style="color:#c0c0c0">ü•à</span><span class="ts-addr">Loading...</span><span class="ts-amount">‚Äî</span></div>
                    <div class="top-staker-row"><span class="ts-rank" style="color:#cd7f32">ü•â</span><span class="ts-addr">Loading...</span><span class="ts-amount">‚Äî</span></div>
                </div>
            </div>
        </div>
        <div class="hero-crab">
            <img src="/images/staking/crab-hero.webp" alt="CMEM Crab - staking mascot">
        </div>
    </div>
    <div class="wave-divider">
        <svg viewBox="0 0 1440 120" preserveAspectRatio="none">
            <path d="M0,60 C360,120 720,0 1080,60 C1260,90 1380,60 1440,80 L1440,120 L0,120 Z" fill="var(--ocean)"/>
        </svg>
    </div>
</section>

<!-- HOW IT WORKS -->
<section id="how" style="background:var(--ocean)">
    <div class="section-inner">
        <div class="gradient-line"></div>
        <h2 class="section-title reveal">How It Works</h2>
        <p class="section-subtitle reveal">Three steps. Even a crab with claws can do it.</p>
        <div class="how-cards">
            <div class="how-card reveal">
                <div class="how-step">1</div>
                <div class="how-card-icon">ü¶Ä</div>
                <h3>Go to Streamflow</h3>
                <p>Click the big orange button. It takes you to Streamflow Finance where you'll connect your wallet. Easy peasy, crab squeezy.</p>
            </div>
            <div class="how-card reveal">
                <div class="how-step">2</div>
                <div class="how-card-icon">üí∞</div>
                <h3>Stake $CMEM</h3>
                <p>30 days minimum. We're not day-traders, we're crabs. We hold things with an iron claw.</p>
            </div>
            <div class="how-card reveal">
                <div class="how-step">3</div>
                <div class="how-card-icon">üìà</div>
                <h3>Earn 69% APY</h3>
                <p>Nice. Your tokens work harder than a crab at an all-you-can-eat buffet.</p>
            </div>
        </div>
    </div>
</section>

<!-- LIVE POOL STATS -->
<section class="stats-section">
    <div class="section-inner">
        <div class="gradient-line"></div>
        <h2 class="section-title reveal">Live Pool Stats</h2>
        <p class="section-subtitle reveal">Numbers don't lie. Unlike that "guaranteed 1000x" you saw on Twitter.</p>
        <div class="stats-grid">
            <div class="stat-card reveal">
                <div class="stat-icon">üè¶</div>
                <div class="stat-value" style="color:var(--sol-green)">Loading...</div>
                <div class="stat-label">Total Staked</div>
            </div>
            <div class="stat-card reveal">
                <div class="stat-icon">üî•</div>
                <div class="stat-value" style="color:var(--crab)">69%</div>
                <div class="stat-label">Annual Yield</div>
            </div>
            <div class="stat-card reveal">
                <div class="stat-icon">üë•</div>
                <div class="stat-value" style="color:var(--sol-green)">Loading...</div>
                <div class="stat-label">Active Stakers</div>
            </div>
            <div class="stat-card reveal">
                <div class="stat-icon">‚è≥</div>
                <div class="stat-value" id="countdownValue">--</div>
                <div class="stat-label">Pool Expires</div>
            </div>
        </div>
    </div>
</section>

<!-- STAKING WIDGET -->
<section id="stake" class="widget-section">
    <div class="section-inner">
        <div class="gradient-line"></div>
        <h2 class="section-title reveal">Stake Your $CMEM</h2>
        <p class="section-subtitle reveal">Put those tokens to work. They've been sitting in your wallet doing nothing ‚Äî just like you.</p>
        <div class="widget-container reveal">
            <div class="widget">
                <div class="widget-ready-title">Ready to Stake? ü¶Ä</div>
                <p class="widget-ready-sub">Your tokens aren't going to stake themselves.<br>Click the button. Do it. The crab commands you.</p>
                <a href="https://app.streamflow.finance/staking/solana/mainnet/2uBHsavcfVQAgs8nMuMwogaap9BV1MwQuADearz1e6Kg" target="_blank" rel="noopener noreferrer" class="mega-stake-btn">
                    STAKE ON STREAMFLOW ü¶Ä
                </a>
                <p class="widget-hint">Opens <a href="https://app.streamflow.finance/staking/solana/mainnet/2uBHsavcfVQAgs8nMuMwogaap9BV1MwQuADearz1e6Kg" target="_blank" rel="noopener noreferrer">Streamflow Finance</a> ‚Äî connect your wallet there and stake directly</p>
                <div class="streamflow-badge">
                    Powered by <a href="https://app.streamflow.finance/staking/solana/mainnet/2uBHsavcfVQAgs8nMuMwogaap9BV1MwQuADearz1e6Kg" target="_blank" rel="noopener noreferrer">Streamflow ‚Üó</a>
                </div>
            </div>

            <!-- CALCULATOR -->
            <div class="calculator reveal">
                <h4>üßÆ Earnings Calculator</h4>
                <div class="calc-row">
                    <label>Amount</label>
                    <input type="range" id="calcAmount" min="1000" max="10000000" value="100000" step="1000" oninput="updateCalcSlider()">
                    <span class="calc-val" id="calcAmountVal">100,000</span>
                </div>
                <div class="calc-row">
                    <label>Duration</label>
                    <input type="range" id="calcDays" min="30" max="365" value="90" step="1" oninput="updateCalcSlider()">
                    <span class="calc-val" id="calcDaysVal">90 days</span>
                </div>
                <div class="calc-result">
                    <div class="label">Estimated Earnings</div>
                    <div class="big-num" id="calcResult">17,014 CMEM</div>
                    <div class="label" id="calcDaily" style="margin-top:0.3rem">~189/day</div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- WHY STAKE -->
<section class="why-section">
    <div class="section-inner">
        <div class="gradient-line"></div>
        <h2 class="section-title reveal">Why Stake $CMEM?</h2>
        <p class="section-subtitle reveal">Glad you asked. Sit down. Let the crab explain.</p>
        <div class="why-grid reveal">
            <div class="why-text">
                <h3>Because HODLing Is So 2021</h3>
                <p>Your tokens are sitting in your wallet collecting digital dust. Meanwhile, staked $CMEM is out there working harder than a crab during happy hour.</p>
                <ul class="why-list">
                    <li><strong>69% APY</strong> ‚Äî Yes, that number. No, it's not a coincidence. We're crabs of culture.</li>
                    <li><strong>Powered by Streamflow</strong> ‚Äî Battle-tested staking infrastructure. Not some random contract a crab wrote at 3am.</li>
                    <li><strong>30-Day Minimum</strong> ‚Äî We're filtering out paper claws. If you can't commit for a month, this pool isn't for you.</li>
                    <li><strong>150M Token Pool</strong> ‚Äî Massive rewards pool. First crabs eat first.</li>
                    <li><strong>Community Flex</strong> ‚Äî Climb the leaderboard. Earn badges. Make other crabs jealous.</li>
                </ul>
            </div>
            <div class="why-image">
                <img src="/images/staking/crab-trading.png" alt="Crab at trading desk">
            </div>
        </div>
    </div>
</section>

<!-- LEADERBOARD -->
<section id="leaderboard">
    <div class="section-inner">
        <div class="gradient-line"></div>
        <h2 class="section-title reveal">Staking Leaderboard</h2>
        <p class="section-subtitle reveal">The hall of fame for crabs with the biggest claws. ü¶Äüëë</p>
        <div class="leaderboard-controls reveal">
            <input type="text" class="lb-search" id="lbSearch" placeholder="üîç Search by address..." oninput="filterLeaderboard()">
            <select class="lb-sort" id="lbSort" onchange="sortLeaderboard()">
                <option value="amount-desc">Amount ‚Üì</option>
                <option value="amount-asc">Amount ‚Üë</option>
                <option value="duration-desc">Duration ‚Üì</option>
                <option value="duration-asc">Duration ‚Üë</option>
            </select>
        </div>
        <!-- Desktop table -->
        <div class="lb-table-wrap reveal">
            <table class="leaderboard-table" id="lbTable">
                <thead>
                    <tr>
                        <th onclick="sortBy('rank')">Rank</th>
                        <th onclick="sortBy('address')">Address</th>
                        <th onclick="sortBy('amount')">Amount Staked</th>
                        <th onclick="sortBy('duration')">Duration</th>
                        <th>Badge</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody id="lbBody"></tbody>
            </table>
        </div>
        <!-- Mobile cards -->
        <div class="lb-cards reveal" id="lbCards"></div>
    </div>
</section>

<!-- CONTRACT INFO -->
<section id="contract" class="contract-section">
    <div class="section-inner">
        <div class="gradient-line"></div>
        <h2 class="section-title reveal">Contract Information</h2>
        <p class="section-subtitle reveal">Verify everything. Trust, but verify. Actually, just verify.</p>
        <div class="contract-grid reveal">
            <div class="contract-card">
                <h4>Token Contract</h4>
                <div class="contract-addr">
                    <code>2TsmuYUrsctE57VLckZBYEEzdokUF8j8e1GavekWBAGS</code>
                    <button class="copy-btn" onclick="copyAddr('2TsmuYUrsctE57VLckZBYEEzdokUF8j8e1GavekWBAGS', this)">Copy</button>
                </div>
                <div class="contract-links">
                    <a class="contract-link-btn" href="https://solscan.io/token/2TsmuYUrsctE57VLckZBYEEzdokUF8j8e1GavekWBAGS" target="_blank" rel="noopener noreferrer">Solscan ‚Üó</a>
                    <a class="contract-link-btn" href="https://explorer.solana.com/address/2TsmuYUrsctE57VLckZBYEEzdokUF8j8e1GavekWBAGS" target="_blank" rel="noopener noreferrer">Explorer ‚Üó</a>
                    <span class="verified-badge">‚úì Verified</span>
                </div>
            </div>
            <div class="contract-card">
                <h4>Staking Pool (Streamflow)</h4>
                <div class="contract-addr">
                    <code>2uBHsavcfVQAgs8nMuMwogaap9BV1MwQuADearz1e6Kg</code>
                    <button class="copy-btn" onclick="copyAddr('2uBHsavcfVQAgs8nMuMwogaap9BV1MwQuADearz1e6Kg', this)">Copy</button>
                </div>
                <div class="contract-links">
                    <a class="contract-link-btn" href="https://solscan.io/account/2uBHsavcfVQAgs8nMuMwogaap9BV1MwQuADearz1e6Kg" target="_blank" rel="noopener noreferrer">Solscan ‚Üó</a>
                    <a class="contract-link-btn" href="https://app.streamflow.finance/staking/solana/mainnet/2uBHsavcfVQAgs8nMuMwogaap9BV1MwQuADearz1e6Kg" target="_blank" rel="noopener noreferrer">Streamflow ‚Üó</a>
                    <span class="verified-badge">‚úì Verified</span>
                </div>
            </div>
            <div class="contract-card full-width">
                <h4>Pool Parameters</h4>
                <div class="pool-params">
                    <div class="pool-param"><span class="pool-param-label">Total Rewards</span><span class="pool-param-value">150,000,000 CMEM</span></div>
                    <div class="pool-param"><span class="pool-param-label">APY</span><span class="pool-param-value" style="color:var(--sol-green)">69%</span></div>
                    <div class="pool-param"><span class="pool-param-label">Min Stake Duration</span><span class="pool-param-value">30 days</span></div>
                    <div class="pool-param"><span class="pool-param-label">Pool Expiry</span><span class="pool-param-value">January 27, 2027</span></div>
                    <div class="pool-param"><span class="pool-param-label">Network</span><span class="pool-param-value">Solana Mainnet</span></div>
                    <div class="pool-param"><span class="pool-param-label">Platform</span><span class="pool-param-value">Streamflow Finance</span></div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- FAQ -->
<section id="faq">
    <div class="section-inner">
        <div class="gradient-line"></div>
        <h2 class="section-title reveal">FAQ</h2>
        <p class="section-subtitle reveal">Questions we get asked by crabs who think they're smarter than us.</p>
        <div class="faq-list reveal">
            <div class="faq-item">
                <div class="faq-q" onclick="toggleFaq(this)">
                    <span>ü¶Ä Is this safe?</span>
                    <span class="faq-toggle">+</span>
                </div>
                <div class="faq-a"><div class="faq-a-inner"><p>As safe as a crab's shell. The staking pool runs on Streamflow Finance ‚Äî a battle-tested protocol on Solana. Smart contracts are verified and auditable on-chain. We don't have access to your funds. Your wallet, your keys, your tokens. We just built a really nice page to make staking them feel fancy.</p></div></div>
            </div>
            <div class="faq-item">
                <div class="faq-q" onclick="toggleFaq(this)">
                    <span>üí∞ What's the minimum stake?</span>
                    <span class="faq-toggle">+</span>
                </div>
                <div class="faq-a"><div class="faq-a-inner"><p>The minimum lock period is 30 days. Amount-wise, you can stake any amount of $CMEM you hold. We're not elitist ‚Äî every crab counts. But seriously, if you're staking 12 tokens‚Ä¶ maybe buy more first.</p></div></div>
            </div>
            <div class="faq-item">
                <div class="faq-q" onclick="toggleFaq(this)">
                    <span>üìÖ When do rewards distribute?</span>
                    <span class="faq-toggle">+</span>
                </div>
                <div class="faq-a"><div class="faq-a-inner"><p>Rewards accrue continuously through the Streamflow staking protocol. You can claim earned rewards at any time after your lock period ends. The pool has 150M CMEM allocated for rewards and runs until January 27, 2027.</p></div></div>
            </div>
            <div class="faq-item">
                <div class="faq-q" onclick="toggleFaq(this)">
                    <span>‚è∞ What happens when the pool expires?</span>
                    <span class="faq-toggle">+</span>
                </div>
                <div class="faq-a"><div class="faq-a-inner"><p>The pool expires January 27, 2027. After expiry, no new staking is accepted, but you can still unstake and claim any remaining rewards. Any unclaimed rewards in the pool are handled according to Streamflow's protocol rules. TL;DR: get in early, stay staked, maximize gains.</p></div></div>
            </div>
            <div class="faq-item">
                <div class="faq-q" onclick="toggleFaq(this)">
                    <span>üîÑ Can I unstake early?</span>
                    <span class="faq-toggle">+</span>
                </div>
                <div class="faq-a"><div class="faq-a-inner"><p>After your 30-day minimum lock period? Yes. Before that? No. We told you ‚Äî diamond claws only. This isn't a revolving door, it's a crab fortress. Commit or don't. (But seriously, commit.)</p></div></div>
            </div>
            <div class="faq-item">
                <div class="faq-q" onclick="toggleFaq(this)">
                    <span>ü§î Why 69% APY?</span>
                    <span class="faq-toggle">+</span>
                </div>
                <div class="faq-a"><div class="faq-a-inner"><p>Nice. Next question.</p></div></div>
            </div>
        </div>
    </div>
</section>

<!-- FOOTER -->
<footer>
    <div class="footer-inner">
        <div class="footer-links">
            <a href="https://cmem.ai">Main Site</a>
            <a href="https://twitter.com/Claude_Memory" target="_blank" rel="noopener noreferrer">Twitter</a>
            <a href="https://t.me/crabmem" target="_blank" rel="noopener noreferrer">Telegram</a>
            <a href="https://github.com/thedotmack/crab-mem" target="_blank" rel="noopener noreferrer">GitHub</a>
            <a href="/bounties">Bounties</a>
        </div>
        <p class="footer-tagline">Built by crabs, for crabs. ü¶Ä Diamond claws since 2026.</p>
        <p class="footer-addr">$CMEM: 2TsmuYUrsctE57VLckZBYEEzdokUF8j8e1GavekWBAGS</p>
    </div>
</footer>

<script>
(function() {
    'use strict';

    const POOL_ADDR = '2uBHsavcfVQAgs8nMuMwogaap9BV1MwQuADearz1e6Kg';
    const POOL_EXPIRY = new Date('2027-01-26T05:00:00Z');

    let leaderboardData = [];
    const STAKING_API = '/api/staking';
    let stakingDataLoaded = false;

    async function fetchStakingData() {
        try {
            const res = await fetch(STAKING_API);
            if (!res.ok) throw new Error('API returned ' + res.status);
            const data = await res.json();
            if (data.error) throw new Error(data.message);

            const totalStaked = data.pool.totalStaked;
            const stakerCount = data.pool.stakerCount;

            const heroPoolEl = document.getElementById('heroTotalStaked');
            if (heroPoolEl) heroPoolEl.textContent = formatAbbr(totalStaked);

            const statValues = document.querySelectorAll('.stat-card .stat-value');
            statValues.forEach(el => {
                const label = el.nextElementSibling?.textContent?.trim();
                if (label === 'Total Staked') {
                    el.textContent = formatAbbr(totalStaked) + ' CMEM';
                    el.removeAttribute('data-count');
                } else if (label === 'Active Stakers') {
                    el.textContent = stakerCount.toString();
                    el.removeAttribute('data-count');
                }
            });

            leaderboardData = data.stakers.map((s, i) => {
                const rank = i + 1;
                let badge = 'üêê';
                if (rank === 1) badge = 'üëë ' + badge;
                if (s.amount >= 500000000) badge = 'üíé ' + badge;
                else if (s.amount >= 100000000) badge = 'ü¶Ä ' + badge;
                return {
                    rank, addr: s.address.slice(0, 8) + '...' + s.address.slice(-4),
                    full: s.address, amount: Math.round(s.amount),
                    duration: s.duration, badge,
                };
            });
            renderLeaderboard(leaderboardData);
            updateTopStakers(leaderboardData.slice(0, 3));
            stakingDataLoaded = true;
        } catch (err) {
            console.error('Failed to fetch staking data:', err);
            if (!stakingDataLoaded) {
                document.getElementById('lbBody').innerHTML = '<tr><td colspan="6" style="text-align:center;color:var(--white-dim);padding:2rem;">Data unavailable ‚Äî try refreshing</td></tr>';
            }
        }
    }

    function updateTopStakers(top3) {
        const medals = ['ü•á', 'ü•à', 'ü•â'];
        const colors = ['#ffd700', '#c0c0c0', '#cd7f32'];
        const container = document.getElementById('heroTopList');
        if (!container || top3.length === 0) return;
        container.innerHTML = top3.map((s, i) =>
            `<div class="top-staker-row"><span class="ts-rank" style="color:${colors[i]}">${medals[i]}</span><span class="ts-addr">${s.addr}</span><span class="ts-amount">${formatAbbr(s.amount)}</span></div>`
        ).join('');
    }

    function formatAbbr(n) {
        if (n >= 1e9) return (n / 1e9).toFixed(2) + 'B';
        if (n >= 1e6) return (n / 1e6).toFixed(1) + 'M';
        if (n >= 1e3) return (n / 1e3).toFixed(0) + 'K';
        return formatNumber(Math.round(n));
    }

    window.addEventListener('DOMContentLoaded', () => {
        initCounters();
        initScrollReveal();
        updateCountdown();
        setInterval(updateCountdown, 60000);
        updateCalcSlider();
        fetchStakingData();
        setInterval(fetchStakingData, 60000);
    });

    window.updateCalcSlider = function() {
        const amount = parseInt(document.getElementById('calcAmount').value);
        const days = parseInt(document.getElementById('calcDays').value);
        document.getElementById('calcAmountVal').textContent = formatNumber(amount);
        document.getElementById('calcDaysVal').textContent = days + ' days';
        const earnings = amount * 0.69 / 365 * days;
        const daily = amount * 0.69 / 365;
        document.getElementById('calcResult').textContent = formatNumber(Math.round(earnings)) + ' CMEM';
        document.getElementById('calcDaily').textContent = '~' + formatNumber(Math.round(daily)) + '/day';
    };

    function renderLeaderboard(data) {
        // Desktop table
        const tbody = document.getElementById('lbBody');
        tbody.textContent = '';
        if (data.length === 0 && !stakingDataLoaded) {
            tbody.innerHTML = '<tr><td colspan="6" style="text-align:center;color:var(--white-dim);padding:2rem;">Loading stakers...</td></tr>';
        }
        data.forEach(item => {
            const tr = document.createElement('tr');
            const rankClass = item.rank <= 3 ? ' rank-' + item.rank : '';
            const solscanLink = item.full ? `https://solscan.io/account/${item.full}` : '#';
            tr.innerHTML = `
                <td class="rank-cell${rankClass}">#${item.rank}</td>
                <td class="addr-cell"><a href="${solscanLink}" target="_blank" rel="noopener noreferrer" style="color:inherit;text-decoration:none;" title="${item.full || ''}">${item.addr}</a></td>
                <td class="amount-cell">${formatNumber(item.amount)}</td>
                <td>${item.duration}d</td>
                <td class="badge-cell">${item.badge}</td>
                <td><button class="share-btn" onclick="shareTweet(${item.rank}, '${item.addr}', ${item.amount})">ùïè Share</button></td>
            `;
            tbody.appendChild(tr);
        });

        // Mobile cards
        const cardsContainer = document.getElementById('lbCards');
        if (cardsContainer) {
            cardsContainer.innerHTML = data.map(item => {
                const rankClass = item.rank <= 3 ? ' rank-' + item.rank : '';
                return `<div class="lb-card">
                    <div class="lb-card-rank${rankClass}">#${item.rank}</div>
                    <div class="lb-card-info">
                        <div class="lb-card-addr" title="${item.full}">${item.addr}</div>
                        <div class="lb-card-amount">${formatNumber(item.amount)} CMEM</div>
                        <div class="lb-card-meta">${item.duration}d lock</div>
                    </div>
                    <div class="lb-card-badge">${item.badge}</div>
                </div>`;
            }).join('');
        }
    }

    window.shareTweet = function(rank, addr, amount) {
        const text = encodeURIComponent(`I'm ranked #${rank} on the $CMEM staking leaderboard with ${formatNumber(amount)} CMEM staked! ü¶Ä\n\n69% APY ‚Äî diamond claws only.\n\nhttps://staking.cmem.ai`);
        window.open('https://twitter.com/intent/tweet?text=' + text, '_blank');
    };

    window.filterLeaderboard = function() {
        const q = document.getElementById('lbSearch').value.toLowerCase();
        const filtered = leaderboardData.filter(d => d.addr.toLowerCase().includes(q) || d.full.toLowerCase().includes(q));
        renderLeaderboard(filtered);
    };

    window.sortLeaderboard = function() {
        const val = document.getElementById('lbSort').value;
        const sorted = [...leaderboardData];
        const [key, dir] = val.split('-');
        sorted.sort((a, b) => dir === 'desc' ? b[key] - a[key] : a[key] - b[key]);
        sorted.forEach((item, i) => item.rank = i + 1);
        renderLeaderboard(sorted);
    };

    window.sortBy = function(col) {
        const select = document.getElementById('lbSort');
        if (col === 'amount') select.value = select.value === 'amount-desc' ? 'amount-asc' : 'amount-desc';
        if (col === 'duration') select.value = select.value === 'duration-desc' ? 'duration-asc' : 'duration-desc';
        sortLeaderboard();
    };

    function initCounters() {
        const counters = document.querySelectorAll('[data-count]');
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting && !entry.target.dataset.animated) {
                    entry.target.dataset.animated = 'true';
                    animateCounter(entry.target);
                }
            });
        }, { threshold: 0.3 });
        counters.forEach(c => observer.observe(c));
    }

    function animateCounter(el) {
        const target = parseInt(el.dataset.count);
        const suffix = el.dataset.suffix || '';
        const fmt = el.dataset.format;
        const duration = 2000;
        const start = performance.now();
        function update(now) {
            const elapsed = now - start;
            const progress = Math.min(elapsed / duration, 1);
            const eased = 1 - Math.pow(1 - progress, 3);
            const current = Math.round(target * eased);
            if (fmt === 'abbr') {
                el.textContent = current >= 1000000 ? (current / 1000000).toFixed(0) + 'M' + suffix : formatNumber(current) + suffix;
            } else {
                el.textContent = formatNumber(current) + suffix;
            }
            if (progress < 1) requestAnimationFrame(update);
        }
        requestAnimationFrame(update);
    }

    function updateCountdown() {
        const now = new Date();
        const diff = POOL_EXPIRY - now;
        if (diff <= 0) { document.getElementById('countdownValue').textContent = 'Expired'; return; }
        const days = Math.floor(diff / (1000 * 60 * 60 * 24));
        const months = Math.floor(days / 30);
        document.getElementById('countdownValue').textContent = months > 0 ? months + 'mo ' + (days % 30) + 'd' : days + ' days';
    }

    function initScrollReveal() {
        const observer = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) entry.target.classList.add('visible');
            });
        }, { threshold: 0.1, rootMargin: '0px 0px -50px 0px' });
        document.querySelectorAll('.reveal').forEach(el => observer.observe(el));
    }

    window.toggleFaq = function(el) {
        const item = el.closest('.faq-item');
        const wasOpen = item.classList.contains('open');
        document.querySelectorAll('.faq-item').forEach(i => i.classList.remove('open'));
        if (!wasOpen) item.classList.add('open');
    };

    window.copyAddr = function(addr, btn) {
        navigator.clipboard.writeText(addr).then(() => {
            const orig = btn.textContent;
            btn.textContent = 'Copied!';
            btn.style.color = 'var(--sol-green)';
            setTimeout(() => { btn.textContent = orig; btn.style.color = ''; }, 2000);
        });
    };

    function formatNumber(n) {
        return n.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ',');
    }

})();
</script>
</body>
</html>
